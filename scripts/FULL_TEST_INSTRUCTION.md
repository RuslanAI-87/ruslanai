# Инструкция по тестированию полной системы RuslanAI

## Предварительная подготовка

1. Убедитесь, что все компоненты системы имеют актуальные версии:
   - WebSocket сервер (fixed_direct_bridge.py)
   - API сервер (fixed_api_server.py)
   - Веб-интерфейс (обновлены импорты ES модулей)

2. Очистите все временные файлы и кэши:
   ```powershell
   cd C:\RuslanAI\web_ui
   npm cache clean --force
   ```

## Порядок запуска системы

### 1. Запуск WebSocket моста

```powershell
cd C:\RuslanAI\scripts
python fixed_direct_bridge.py
```

В отдельном окне PowerShell запускаем мост WebSocket, который будет работать на порту 8005. Это компонент обеспечивает обмен сообщениями в реальном времени между веб-интерфейсом и системой памяти.

### 2. Запуск API сервера

```powershell
cd C:\RuslanAI\scripts
python fixed_api_server.py
```

В другом окне PowerShell запускаем API сервер, который будет работать на порту 8001. Этот компонент обрабатывает HTTP запросы от веб-интерфейса.

### 3. Запуск веб-интерфейса

```powershell
cd C:\RuslanAI\web_ui
npm run dev
```

В третьем окне PowerShell запускаем веб-интерфейс. После запуска откройте браузер и перейдите по адресу http://localhost:3000.

### 4. Автоматический запуск всех компонентов

Для удобства вы можете использовать скрипт полного запуска, который запустит все компоненты в правильном порядке:

```powershell
cd C:\RuslanAI\scripts
.\run_fixed_system.ps1
```

## Тестирование функциональности

### 1. Проверка WebSocket соединения

1. Откройте инструменты разработчика в браузере (F12)
2. Перейдите на вкладку "Console"
3. Убедитесь, что в консоли есть сообщение "WebSocket connection established"

Для более детальной проверки WebSocket соединения используйте тестовую страницу:
```
C:\RuslanAI\scripts\test_websocket_connection.html
```

### 2. Проверка отправки сообщений

1. Введите сообщение в поле ввода на веб-интерфейсе
2. Нажмите кнопку отправки (или Enter)
3. Убедитесь, что сообщение отображается в чате
4. Проверьте, что появился индикатор обработки запроса
5. Дождитесь ответа от системы

### 3. Проверка основных функций

1. **Проверка состояния агентов:**
   - Убедитесь, что в интерфейсе отображается правильное состояние агентов

2. **Проверка кириллических символов:**
   - Отправьте сообщение с русским текстом
   - Убедитесь, что символы отображаются корректно

3. **Проверка обработки задач:**
   - Отправьте сложный запрос, требующий длительной обработки
   - Убедитесь, что статус задачи отображается правильно

## Устранение возможных проблем

### 1. Проблемы с WebSocket

**Симптом:** Ошибки подключения WebSocket в консоли.

**Решение:**
- Проверьте, что сервер WebSocket запущен и работает на порту 8005
- Убедитесь, что в websocketService.js указан правильный URL: `ws://localhost:8005`

### 2. Проблемы с импортом модулей

**Симптом:** Ошибки импорта модулей в консоли браузера.

**Решение:**
- Проверьте, что все импорты содержат расширения файлов (.js, .jsx)
- Перезапустите веб-сервер Vite

### 3. Проблемы с API сервером

**Симптом:** Ошибки отправки сообщений, запросы не доходят до сервера.

**Решение:**
- Проверьте, что API сервер запущен и работает на порту 8001
- Убедитесь, что в agentService.js указан правильный URL: `http://localhost:8001`

## Журналы и отладка

Для анализа проблем используйте следующие журналы:

1. **WebSocket мост:** `C:\RuslanAI\logs\fixed_bridge.log`
2. **API сервер:** `C:\RuslanAI\logs\api_server.log`
3. **Консоль браузера:** Инструменты разработчика (F12) > Console

## Дополнительные рекомендации

1. Регулярно очищайте кэш браузера при разработке
2. Используйте режим инкогнито для тестирования, чтобы избежать проблем с кэшированием
3. Всегда проверяйте консоль браузера на наличие ошибок
4. При внесении изменений в код перезапускайте соответствующие компоненты